define(["exports","./Transforms-fce95115","./Matrix2-413c4048","./Matrix3-81054f0f","./ComponentDatatype-ab629b88","./defaultValue-f6d5e6da","./GeometryAttribute-81ff775c","./GeometryAttributes-1e4ddcd2","./GeometryOffsetAttribute-2579b8d2","./IndexDatatype-d3db4e7d","./Math-2ce22ee9","./VertexFormat-fbdec922"],function(t,e,a,i,n,r,o,m,s,u,l,f){"use strict";let c;let d=new i.Cartesian3,C=new i.Cartesian3,p=new i.Cartesian3,y=new i.Cartesian3,_=new i.Cartesian3,h=new i.Cartesian3(1,1,1),x=Math.cos,A=Math.sin;function b(t){t=r.defaultValue(t,r.defaultValue.EMPTY_OBJECT);let e=r.defaultValue(t.radii,h),a=r.defaultValue(t.innerRadii,e),n=r.defaultValue(t.minimumClock,0),o=r.defaultValue(t.maximumClock,l.CesiumMath.TWO_PI),m=r.defaultValue(t.minimumCone,0),s=r.defaultValue(t.maximumCone,l.CesiumMath.PI),u=Math.round(r.defaultValue(t.stackPartitions,64)),c=Math.round(r.defaultValue(t.slicePartitions,64)),d=r.defaultValue(t.vertexFormat,f.VertexFormat.DEFAULT);this._radii=i.Cartesian3.clone(e),this._innerRadii=i.Cartesian3.clone(a),this._minimumClock=n,this._maximumClock=o,this._minimumCone=m,this._maximumCone=s,this._stackPartitions=u,this._slicePartitions=c,this._vertexFormat=f.VertexFormat.clone(d),this._offsetAttribute=t.offsetAttribute,this._workerName="createEllipsoidGeometry"}b.packedLength=2*i.Cartesian3.packedLength+f.VertexFormat.packedLength+7,b.pack=function(t,e,a){return a=r.defaultValue(a,0),i.Cartesian3.pack(t._radii,e,a),a+=i.Cartesian3.packedLength,i.Cartesian3.pack(t._innerRadii,e,a),a+=i.Cartesian3.packedLength,f.VertexFormat.pack(t._vertexFormat,e,a),a+=f.VertexFormat.packedLength,e[a++]=t._minimumClock,e[a++]=t._maximumClock,e[a++]=t._minimumCone,e[a++]=t._maximumCone,e[a++]=t._stackPartitions,e[a++]=t._slicePartitions,e[a]=r.defaultValue(t._offsetAttribute,-1),e};let k=new i.Cartesian3,P=new i.Cartesian3,g=new f.VertexFormat,v={radii:k,innerRadii:P,vertexFormat:g,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};b.unpack=function(t,e,a){e=r.defaultValue(e,0);let n=i.Cartesian3.unpack(t,e,k);e+=i.Cartesian3.packedLength;let o=i.Cartesian3.unpack(t,e,P);e+=i.Cartesian3.packedLength;let m=f.VertexFormat.unpack(t,e,g);e+=f.VertexFormat.packedLength;let s=t[e++],u=t[e++],l=t[e++],c=t[e++],d=t[e++],C=t[e++],p=t[e];return r.defined(a)?(a._radii=i.Cartesian3.clone(n,a._radii),a._innerRadii=i.Cartesian3.clone(o,a._innerRadii),a._vertexFormat=f.VertexFormat.clone(m,a._vertexFormat),a._minimumClock=s,a._maximumClock=u,a._minimumCone=l,a._maximumCone=c,a._stackPartitions=d,a._slicePartitions=C,a._offsetAttribute=-1===p?void 0:p,a):(v.minimumClock=s,v.maximumClock=u,v.minimumCone=l,v.maximumCone=c,v.stackPartitions=d,v.slicePartitions=C,v.offsetAttribute=-1===p?void 0:p,new b(v))},b.createGeometry=function(t){let f;let c=t._radii;if(c.x<=0||c.y<=0||c.z<=0)return;let h=t._innerRadii;if(h.x<=0||h.y<=0||h.z<=0)return;let b=t._minimumClock,k=t._maximumClock,P=t._minimumCone,g=t._maximumCone,v=t._vertexFormat,F,w,V=t._slicePartitions+1,M=t._stackPartitions+1;V=Math.round(V*Math.abs(k-b)/l.CesiumMath.TWO_PI),M=Math.round(M*Math.abs(g-P)/l.CesiumMath.PI),V<2&&(V=2),M<2&&(M=2);let T=0,D=[P],G=[b];for(F=0;F<M;F++)D.push(P+F*(g-P)/(M-1));for(D.push(g),w=0;w<V;w++)G.push(b+w*(k-b)/(V-1));G.push(k);let L=D.length,O=G.length,I=0,E=1,z=h.x!==c.x||h.y!==c.y||h.z!==c.z,N=!1,R=!1,U=!1;z&&(E=2,P>0&&(N=!0,I+=V-1),g<Math.PI&&(R=!0,I+=V-1),(k-b)%l.CesiumMath.TWO_PI?(U=!0,I+=2*(M-1)+1):I+=1);let S=O*L*E,B=new Float64Array(3*S),W=Array(S).fill(!1),Y=Array(S).fill(!1),J=V*M*E,X=6*(J+I+1-(V+M)*E),Z=u.IndexDatatype.createTypedArray(J,X),j=v.normal?new Float32Array(3*S):void 0,q=v.tangent?new Float32Array(3*S):void 0,H=v.bitangent?new Float32Array(3*S):void 0,K=v.st?new Float32Array(2*S):void 0,Q=Array(L),$=Array(L);for(F=0;F<L;F++)Q[F]=A(D[F]),$[F]=x(D[F]);let tt=Array(O),te=Array(O);for(w=0;w<O;w++)te[w]=x(G[w]),tt[w]=A(G[w]);for(F=0;F<L;F++)for(w=0;w<O;w++)B[T++]=c.x*Q[F]*te[w],B[T++]=c.y*Q[F]*tt[w],B[T++]=c.z*$[F];let ta,ti,tn,tr,to=S/2;if(z)for(F=0;F<L;F++)for(w=0;w<O;w++)B[T++]=h.x*Q[F]*te[w],B[T++]=h.y*Q[F]*tt[w],B[T++]=h.z*$[F],W[to]=!0,F>0&&F!==L-1&&0!==w&&w!==O-1&&(Y[to]=!0),to++;for(T=0,F=1;F<L-2;F++)for(ta=F*O,ti=(F+1)*O,w=1;w<O-2;w++)Z[T++]=ti+w,Z[T++]=ti+w+1,Z[T++]=ta+w+1,Z[T++]=ti+w,Z[T++]=ta+w+1,Z[T++]=ta+w;if(z){let t=L*O;for(F=1;F<L-2;F++)for(ta=t+F*O,ti=t+(F+1)*O,w=1;w<O-2;w++)Z[T++]=ti+w,Z[T++]=ta+w,Z[T++]=ta+w+1,Z[T++]=ti+w,Z[T++]=ta+w+1,Z[T++]=ti+w+1}if(z){if(N)for(tr=L*O,F=1;F<O-2;F++)Z[T++]=F,Z[T++]=F+1,Z[T++]=tr+F+1,Z[T++]=F,Z[T++]=tr+F+1,Z[T++]=tr+F;if(R)for(tn=L*O-O,tr=L*O*E-O,F=1;F<O-2;F++)Z[T++]=tn+F+1,Z[T++]=tn+F,Z[T++]=tr+F,Z[T++]=tn+F+1,Z[T++]=tr+F,Z[T++]=tr+F+1}if(U){for(F=1;F<L-2;F++)tr=O*L+O*F,tn=O*F,Z[T++]=tr,Z[T++]=tn+O,Z[T++]=tn,Z[T++]=tr,Z[T++]=tr+O,Z[T++]=tn+O;for(F=1;F<L-2;F++)tr=O*L+O*(F+1)-1,tn=O*(F+1)-1,Z[T++]=tn+O,Z[T++]=tr,Z[T++]=tn,Z[T++]=tn+O,Z[T++]=tr+O,Z[T++]=tr}let tm=new m.GeometryAttributes;v.position&&(tm.position=new o.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:B}));let ts=0,tu=0,tl=0,tf=0,tc=S/2,td=i.Ellipsoid.fromCartesian3(c),tC=i.Ellipsoid.fromCartesian3(h);if(v.st||v.normal||v.tangent||v.bitangent){for(F=0;F<S;F++){f=W[F]?tC:td;let t=i.Cartesian3.fromArray(B,3*F,d),e=f.geodeticSurfaceNormal(t,C);if(Y[F]&&i.Cartesian3.negate(e,e),v.st){let t=a.Cartesian2.negate(e,_);K[ts++]=Math.atan2(t.y,t.x)/l.CesiumMath.TWO_PI+.5,K[ts++]=Math.asin(e.z)/Math.PI+.5}if(v.normal&&(j[tu++]=e.x,j[tu++]=e.y,j[tu++]=e.z),v.tangent||v.bitangent){let t,a=0;if(W[F]&&(a=tc),t=!N&&F>=a&&F<a+2*O?i.Cartesian3.UNIT_X:i.Cartesian3.UNIT_Z,i.Cartesian3.cross(t,e,p),i.Cartesian3.normalize(p,p),v.tangent&&(q[tl++]=p.x,q[tl++]=p.y,q[tl++]=p.z),v.bitangent){let t=i.Cartesian3.cross(e,p,y);i.Cartesian3.normalize(t,t),H[tf++]=t.x,H[tf++]=t.y,H[tf++]=t.z}}}v.st&&(tm.st=new o.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:K})),v.normal&&(tm.normal=new o.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:j})),v.tangent&&(tm.tangent=new o.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:q})),v.bitangent&&(tm.bitangent=new o.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:H}))}if(r.defined(t._offsetAttribute)){let e=B.length,a=t._offsetAttribute===s.GeometryOffsetAttribute.NONE?0:1,i=new Uint8Array(e/3).fill(a);tm.applyOffset=new o.GeometryAttribute({componentDatatype:n.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}return new o.Geometry({attributes:tm,indices:Z,primitiveType:o.PrimitiveType.TRIANGLES,boundingSphere:e.BoundingSphere.fromEllipsoid(td),offsetAttribute:t._offsetAttribute})},b.getUnitEllipsoid=function(){return r.defined(c)||(c=b.createGeometry(new b({radii:new i.Cartesian3(1,1,1),vertexFormat:f.VertexFormat.POSITION_ONLY}))),c},t.EllipsoidGeometry=b});