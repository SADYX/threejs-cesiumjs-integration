define(["./defaultValue-f6d5e6da","./Matrix3-81054f0f","./Matrix2-413c4048","./Transforms-fce95115","./ComponentDatatype-ab629b88","./GeometryAttribute-81ff775c","./GeometryAttributes-1e4ddcd2","./GeometryOffsetAttribute-2579b8d2","./IndexDatatype-d3db4e7d","./Math-2ce22ee9","./PolygonPipeline-61ca1579","./RectangleGeometryLibrary-a0a06d23","./RuntimeError-9b4ce3fb","./combine-0c102d93","./WebGLConstants-7f557f93","./EllipsoidRhumbLine-77eff028"],function(e,t,i,n,o,a,r,l,u,s,d,p,c,f,g,h){"use strict";let y=new n.BoundingSphere,m=new n.BoundingSphere,b=new t.Cartesian3,_=new i.Rectangle;function E(e,t){let i=e._ellipsoid,n=t.height,l=t.width,s=t.northCap,d=t.southCap,c=n,f=2,g=0,h=4;s&&(f-=1,c-=1,g+=1,h-=2),d&&(f-=1,c-=1,g+=1,h-=2),g+=f*l+2*c-h;let y=new Float64Array(3*g),m,_=0,E=0;if(s)p.RectangleGeometryLibrary.computePosition(t,i,!1,E,0,b),y[_++]=b.x,y[_++]=b.y,y[_++]=b.z;else for(m=0;m<l;m++)p.RectangleGeometryLibrary.computePosition(t,i,!1,E,m,b),y[_++]=b.x,y[_++]=b.y,y[_++]=b.z;for(m=l-1,E=1;E<n;E++)p.RectangleGeometryLibrary.computePosition(t,i,!1,E,m,b),y[_++]=b.x,y[_++]=b.y,y[_++]=b.z;if(E=n-1,!d)for(m=l-2;m>=0;m--)p.RectangleGeometryLibrary.computePosition(t,i,!1,E,m,b),y[_++]=b.x,y[_++]=b.y,y[_++]=b.z;for(m=0,E=n-2;E>0;E--)p.RectangleGeometryLibrary.computePosition(t,i,!1,E,m,b),y[_++]=b.x,y[_++]=b.y,y[_++]=b.z;let A=y.length/3*2,G=u.IndexDatatype.createTypedArray(y.length/3,A),R=0;for(let e=0;e<y.length/3-1;e++)G[R++]=e,G[R++]=e+1;G[R++]=y.length/3-1,G[R++]=0;let P=new a.Geometry({attributes:new r.GeometryAttributes,primitiveType:a.PrimitiveType.LINES});return P.attributes.position=new a.GeometryAttribute({componentDatatype:o.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:y}),P.indices=G,P}function A(n){let o=(n=e.defaultValue(n,e.defaultValue.EMPTY_OBJECT)).rectangle,a=e.defaultValue(n.granularity,s.CesiumMath.RADIANS_PER_DEGREE),r=e.defaultValue(n.ellipsoid,t.Ellipsoid.WGS84),l=e.defaultValue(n.rotation,0),u=e.defaultValue(n.height,0),d=e.defaultValue(n.extrudedHeight,u);this._rectangle=i.Rectangle.clone(o),this._granularity=a,this._ellipsoid=r,this._surfaceHeight=Math.max(u,d),this._rotation=l,this._extrudedHeight=Math.min(u,d),this._offsetAttribute=n.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}A.packedLength=i.Rectangle.packedLength+t.Ellipsoid.packedLength+5,A.pack=function(n,o,a){return a=e.defaultValue(a,0),i.Rectangle.pack(n._rectangle,o,a),a+=i.Rectangle.packedLength,t.Ellipsoid.pack(n._ellipsoid,o,a),a+=t.Ellipsoid.packedLength,o[a++]=n._granularity,o[a++]=n._surfaceHeight,o[a++]=n._rotation,o[a++]=n._extrudedHeight,o[a]=e.defaultValue(n._offsetAttribute,-1),o};let G=new i.Rectangle,R=t.Ellipsoid.clone(t.Ellipsoid.UNIT_SPHERE),P={rectangle:G,ellipsoid:R,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};A.unpack=function(n,o,a){o=e.defaultValue(o,0);let r=i.Rectangle.unpack(n,o,G);o+=i.Rectangle.packedLength;let l=t.Ellipsoid.unpack(n,o,R);o+=t.Ellipsoid.packedLength;let u=n[o++],s=n[o++],d=n[o++],p=n[o++],c=n[o];return e.defined(a)?(a._rectangle=i.Rectangle.clone(r,a._rectangle),a._ellipsoid=t.Ellipsoid.clone(l,a._ellipsoid),a._surfaceHeight=s,a._rotation=d,a._extrudedHeight=p,a._offsetAttribute=-1===c?void 0:c,a):(P.granularity=u,P.height=s,P.rotation=d,P.extrudedHeight=p,P.offsetAttribute=-1===c?void 0:c,new A(P))};let L=new t.Cartographic;return A.createGeometry=function(t){let i,r,c;let f=t._rectangle,g=t._ellipsoid,h=p.RectangleGeometryLibrary.computeOptions(f,t._granularity,t._rotation,0,_,L);if(s.CesiumMath.equalsEpsilon(f.north,f.south,s.CesiumMath.EPSILON10)||s.CesiumMath.equalsEpsilon(f.east,f.west,s.CesiumMath.EPSILON10))return;let b=t._surfaceHeight,A=t._extrudedHeight;if(s.CesiumMath.equalsEpsilon(b,A,0,s.CesiumMath.EPSILON2)){if((i=E(t,h)).attributes.position.values=d.PolygonPipeline.scaleToGeodeticHeight(i.attributes.position.values,b,g,!1),e.defined(t._offsetAttribute)){let e=i.attributes.position.values.length;c=t._offsetAttribute===l.GeometryOffsetAttribute.NONE?0:1;let n=new Uint8Array(e/3).fill(c);i.attributes.applyOffset=new a.GeometryAttribute({componentDatatype:o.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}r=n.BoundingSphere.fromRectangle3D(f,g,b)}else{if(i=function(e,t){let i=e._surfaceHeight,n=e._extrudedHeight,o=e._ellipsoid,a=E(e,t),r=t.height,l=t.width,s=d.PolygonPipeline.scaleToGeodeticHeight(a.attributes.position.values,i,o,!1),p=s.length,c=new Float64Array(2*p);c.set(s);let f=d.PolygonPipeline.scaleToGeodeticHeight(a.attributes.position.values,n,o);c.set(f,p),a.attributes.position.values=c;let g=t.northCap,h=t.southCap,y=4;g&&(y-=1),h&&(y-=1);let m=2*(c.length/3+y),b=u.IndexDatatype.createTypedArray(c.length/3,m);p=c.length/6;let _,A=0;for(let e=0;e<p-1;e++)b[A++]=e,b[A++]=e+1,b[A++]=e+p,b[A++]=e+p+1;if(b[A++]=p-1,b[A++]=0,b[A++]=p+p-1,b[A++]=p,b[A++]=0,b[A++]=p,g)_=r-1;else{let e=l-1;b[A++]=e,b[A++]=e+p,_=l+r-2}if(b[A++]=_,b[A++]=_+p,!h){let e=l+_-1;b[A++]=e,b[A]=e+p}return a.indices=b,a}(t,h),e.defined(t._offsetAttribute)){let e=i.attributes.position.values.length/3,n=new Uint8Array(e);t._offsetAttribute===l.GeometryOffsetAttribute.TOP?n=n.fill(1,0,e/2):(c=t._offsetAttribute===l.GeometryOffsetAttribute.NONE?0:1,n=n.fill(c)),i.attributes.applyOffset=new a.GeometryAttribute({componentDatatype:o.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}let s=n.BoundingSphere.fromRectangle3D(f,g,b,m),p=n.BoundingSphere.fromRectangle3D(f,g,A,y);r=n.BoundingSphere.union(s,p)}return new a.Geometry({attributes:i.attributes,indices:i.indices,primitiveType:a.PrimitiveType.LINES,boundingSphere:r,offsetAttribute:t._offsetAttribute})},function(n,o){return e.defined(o)&&(n=A.unpack(n,o)),n._ellipsoid=t.Ellipsoid.clone(n._ellipsoid),n._rectangle=i.Rectangle.clone(n._rectangle),A.createGeometry(n)}});