define(["./RuntimeError-9b4ce3fb","./defaultValue-f6d5e6da","./createTaskProcessorWorker"],function(e,t,i){"use strict";function r(t,i){if(r.passThroughDataForTesting)return i;let n=t.byteLength;if(0===n||n%4!=0)throw new e.RuntimeError("The length of key must be greater than 0 and a multiple of 4.");let a=new DataView(i),o=a.getUint32(0,!0);if(1953029805===o||2917034100===o)return i;let s=new DataView(t),l=0,d=i.byteLength,f=d-d%8,h,c=8;for(;l<f;)for(h=c=(c+8)%24;l<f&&h<n;)a.setUint32(l,a.getUint32(l,!0)^s.getUint32(h,!0),!0),a.setUint32(l+4,a.getUint32(l+4,!0)^s.getUint32(h+4,!0),!0),l+=8,h+=24;if(l<d)for(h>=n&&(h=c=(c+8)%24);l<d;)a.setUint8(l,a.getUint8(l)^s.getUint8(h)),l++,h++}r.passThroughDataForTesting=!1;let n=[1,2,4,8];function a(e,t,i,r,n,a){this._bits=e,this.cnodeVersion=t,this.imageryVersion=i,this.terrainVersion=r,this.imageryProvider=n,this.terrainProvider=a,this.ancestorHasTerrain=!1,this.terrainState=void 0}a.clone=function(e,i){return t.defined(i)?(i._bits=e._bits,i.cnodeVersion=e.cnodeVersion,i.imageryVersion=e.imageryVersion,i.terrainVersion=e.terrainVersion,i.imageryProvider=e.imageryProvider,i.terrainProvider=e.terrainProvider):i=new a(e._bits,e.cnodeVersion,e.imageryVersion,e.terrainVersion,e.imageryProvider,e.terrainProvider),i.ancestorHasTerrain=e.ancestorHasTerrain,i.terrainState=e.terrainState,i},a.prototype.setParent=function(e){this.ancestorHasTerrain=e.ancestorHasTerrain||this.hasTerrain()},a.prototype.hasSubtree=function(){return 0!=(16&this._bits)},a.prototype.hasImagery=function(){return 0!=(64&this._bits)},a.prototype.hasTerrain=function(){return 0!=(128&this._bits)},a.prototype.hasChildren=function(){return 0!=(15&this._bits)},a.prototype.hasChild=function(e){return 0!=(this._bits&n[e])},a.prototype.getChildBitmask=function(){return 15&this._bits};var o={},s={},l=(e,t,i,r)=>{let n=65535&e|0,a=e>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do a=a+(n=n+t[r++]|0)|0;while(--o);n%=65521,a%=65521}return n|a<<16|0};let d=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})());var f=(e,t,i,r)=>{let n=r+i;e^=-1;for(let i=r;i<n;i++)e=e>>>8^d[255&(e^t[i])];return -1^e};let h=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),c=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),u=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),w=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var b={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};let m=function(e,t){let i,r,n,a,o,s,l,d,f,h,c,u,w,b,m,g,k,_,p,y,v,E,x,R;let A=e.state;i=e.next_in,x=e.input,r=i+(e.avail_in-5),n=e.next_out,R=e.output,a=n-(t-e.avail_out),o=n+(e.avail_out-257),s=A.dmax,l=A.wsize,d=A.whave,f=A.wnext,h=A.window,c=A.hold,u=A.bits,w=A.lencode,b=A.distcode,m=(1<<A.lenbits)-1,g=(1<<A.distbits)-1;e:do{u<15&&(c+=x[i++]<<u,u+=8,c+=x[i++]<<u,u+=8),k=w[c&m];t:for(;;){if(c>>>=_=k>>>24,u-=_,0==(_=k>>>16&255))R[n++]=65535&k;else{if(!(16&_)){if(0==(64&_)){k=w[(65535&k)+(c&(1<<_)-1)];continue t}if(32&_){A.mode=16191;break e}e.msg="invalid literal/length code",A.mode=16209;break e}p=65535&k,(_&=15)&&(u<_&&(c+=x[i++]<<u,u+=8),p+=c&(1<<_)-1,c>>>=_,u-=_),u<15&&(c+=x[i++]<<u,u+=8,c+=x[i++]<<u,u+=8),k=b[c&g];i:for(;;){if(c>>>=_=k>>>24,u-=_,!(16&(_=k>>>16&255))){if(0==(64&_)){k=b[(65535&k)+(c&(1<<_)-1)];continue i}e.msg="invalid distance code",A.mode=16209;break e}if(y=65535&k,u<(_&=15)&&(c+=x[i++]<<u,(u+=8)<_&&(c+=x[i++]<<u,u+=8)),(y+=c&(1<<_)-1)>s){e.msg="invalid distance too far back",A.mode=16209;break e}if(c>>>=_,u-=_,y>(_=n-a)){if((_=y-_)>d&&A.sane){e.msg="invalid distance too far back",A.mode=16209;break e}if(v=0,E=h,0===f){if(v+=l-_,_<p){p-=_;do R[n++]=h[v++];while(--_);v=n-y,E=R}}else if(f<_){if(v+=l+f-_,(_-=f)<p){p-=_;do R[n++]=h[v++];while(--_);if(v=0,f<p){p-=_=f;do R[n++]=h[v++];while(--_);v=n-y,E=R}}}else if(v+=f-_,_<p){p-=_;do R[n++]=h[v++];while(--_);v=n-y,E=R}for(;p>2;)R[n++]=E[v++],R[n++]=E[v++],R[n++]=E[v++],p-=3;p&&(R[n++]=E[v++],p>1&&(R[n++]=E[v++]))}else{v=n-y;do R[n++]=R[v++],R[n++]=R[v++],R[n++]=R[v++],p-=3;while(p>2);p&&(R[n++]=R[v++],p>1&&(R[n++]=R[v++]))}break}}break}}while(i<r&&n<o);i-=p=u>>3,u-=p<<3,c&=(1<<u)-1,e.next_in=i,e.next_out=n,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=n<o?o-n+257:257-(n-o),A.hold=c,A.bits=u},g=(e,t,i,r,n,a,o,s)=>{let l=s.bits,d,f,b,m,g,k,_=0,p=0,y=0,v=0,E=0,x=0,R=0,A=0,T=0,U=0,S=null,Z=new Uint16Array(16),D=new Uint16Array(16),I,O,B,N=null;for(_=0;_<=15;_++)Z[_]=0;for(p=0;p<r;p++)Z[t[i+p]]++;for(E=l,v=15;v>=1&&0===Z[v];v--);if(E>v&&(E=v),0===v)return n[a++]=20971520,n[a++]=20971520,s.bits=1,0;for(y=1;y<v&&0===Z[y];y++);for(E<y&&(E=y),A=1,_=1;_<=15;_++)if(A<<=1,(A-=Z[_])<0)return -1;if(A>0&&(0===e||1!==v))return -1;for(D[1]=0,_=1;_<15;_++)D[_+1]=D[_]+Z[_];for(p=0;p<r;p++)0!==t[i+p]&&(o[D[t[i+p]]++]=p);if(0===e?(S=N=o,k=20):1===e?(S=h,N=c,k=257):(S=u,N=w,k=0),U=0,p=0,_=y,g=a,x=E,R=0,b=-1,m=(T=1<<E)-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){I=_-R,o[p]+1<k?(O=0,B=o[p]):o[p]>=k?(O=N[o[p]-k],B=S[o[p]-k]):(O=96,B=0),d=1<<_-R,y=f=1<<x;do n[g+(U>>R)+(f-=d)]=I<<24|O<<16|B|0;while(0!==f);for(d=1<<_-1;U&d;)d>>=1;if(0!==d?(U&=d-1,U+=d):U=0,p++,0==--Z[_]){if(_===v)break;_=t[i+o[p]]}if(_>E&&(U&m)!==b){for(0===R&&(R=E),g+=y,A=1<<(x=_-R);x+R<v&&!((A-=Z[x+R])<=0);)x++,A<<=1;if(T+=1<<x,1===e&&T>852||2===e&&T>592)return 1;n[b=U&m]=E<<24|x<<16|g-a|0}}return 0!==U&&(n[g+U]=_-R<<24|4194304),s.bits=E,0},{Z_FINISH:k,Z_BLOCK:_,Z_TREES:p,Z_OK:y,Z_STREAM_END:v,Z_NEED_DICT:E,Z_STREAM_ERROR:x,Z_DATA_ERROR:R,Z_MEM_ERROR:A,Z_BUF_ERROR:T,Z_DEFLATED:U}=b,S=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Z(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}let D=e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.mode<16180||t.mode>16211?1:0},I=e=>{if(D(e))return x;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=16180,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,y},O=e=>{if(D(e))return x;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,I(e)},B=(e,t)=>{let i;if(D(e))return x;let r=e.state;return t<0?(i=0,t=-t):(i=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?x:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,O(e))},N=(e,t)=>{if(!e)return x;let i=new Z;e.state=i,i.strm=e,i.window=null,i.mode=16180;let r=B(e,t);return r!==y&&(e.state=null),r},C,M,L=!0,F=e=>{if(L){C=new Int32Array(512),M=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(g(1,e.lens,0,288,C,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;g(2,e.lens,0,32,M,0,e.work,{bits:5}),L=!1}e.lencode=C,e.lenbits=9,e.distcode=M,e.distbits=5},P=(e,t,i,r)=>{let n;let a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(i-a.wsize,i),0),a.wnext=0,a.whave=a.wsize):((n=a.wsize-a.wnext)>r&&(n=r),a.window.set(t.subarray(i-r,i-r+n),a.wnext),(r-=n)?(a.window.set(t.subarray(i-r,i),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=n,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=n))),0};s.inflateReset=O,s.inflateReset2=B,s.inflateResetKeep=I,s.inflateInit=e=>N(e,15),s.inflateInit2=N,s.inflate=(e,t)=>{let i,r,n,a,o,s,d,h,c,u,w,b,Z,I,O,B,N,C,M,L,z,V,H,j,K=0,Y=new Uint8Array(4),G=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(D(e)||!e.output||!e.input&&0!==e.avail_in)return x;16191===(n=e.state).mode&&(n.mode=16192),d=e.next_out,o=e.output,c=e.avail_out,s=e.next_in,a=e.input,h=e.avail_in,u=n.hold,w=n.bits,b=h,Z=c,j=y;e:for(;;)switch(n.mode){case 16180:if(0===n.wrap){n.mode=16192;break}for(;w<16;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}if(2&n.wrap&&35615===u){0===n.wbits&&(n.wbits=15),n.check=0,Y[0]=255&u,Y[1]=u>>>8&255,n.check=f(n.check,Y,2,0),u=0,w=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=16209;break}if((15&u)!==U){e.msg="unknown compression method",n.mode=16209;break}if(u>>>=4,w-=4,H=8+(15&u),0===n.wbits&&(n.wbits=H),H>15||H>n.wbits){e.msg="invalid window size",n.mode=16209;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&u?16189:16191,u=0,w=0;break;case 16181:for(;w<16;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}if(n.flags=u,(255&n.flags)!==U){e.msg="unknown compression method",n.mode=16209;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=16209;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&4&n.wrap&&(Y[0]=255&u,Y[1]=u>>>8&255,n.check=f(n.check,Y,2,0)),u=0,w=0,n.mode=16182;case 16182:for(;w<32;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}n.head&&(n.head.time=u),512&n.flags&&4&n.wrap&&(Y[0]=255&u,Y[1]=u>>>8&255,Y[2]=u>>>16&255,Y[3]=u>>>24&255,n.check=f(n.check,Y,4,0)),u=0,w=0,n.mode=16183;case 16183:for(;w<16;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&4&n.wrap&&(Y[0]=255&u,Y[1]=u>>>8&255,n.check=f(n.check,Y,2,0)),u=0,w=0,n.mode=16184;case 16184:if(1024&n.flags){for(;w<16;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&4&n.wrap&&(Y[0]=255&u,Y[1]=u>>>8&255,n.check=f(n.check,Y,2,0)),u=0,w=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&((I=n.length)>h&&(I=h),I&&(n.head&&(H=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(a.subarray(s,s+I),H)),512&n.flags&&4&n.wrap&&(n.check=f(n.check,a,I,s)),h-=I,s+=I,n.length-=I),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===h)break e;I=0;do H=a[s+I++],n.head&&H&&n.length<65536&&(n.head.name+=String.fromCharCode(H));while(H&&I<h);if(512&n.flags&&4&n.wrap&&(n.check=f(n.check,a,I,s)),h-=I,s+=I,H)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===h)break e;I=0;do H=a[s+I++],n.head&&H&&n.length<65536&&(n.head.comment+=String.fromCharCode(H));while(H&&I<h);if(512&n.flags&&4&n.wrap&&(n.check=f(n.check,a,I,s)),h-=I,s+=I,H)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;w<16;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}if(4&n.wrap&&u!==(65535&n.check)){e.msg="header crc mismatch",n.mode=16209;break}u=0,w=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=16191;break;case 16189:for(;w<32;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}e.adler=n.check=S(u),u=0,w=0,n.mode=16190;case 16190:if(0===n.havedict)return e.next_out=d,e.avail_out=c,e.next_in=s,e.avail_in=h,n.hold=u,n.bits=w,E;e.adler=n.check=1,n.mode=16191;case 16191:if(t===_||t===p)break e;case 16192:if(n.last){u>>>=7&w,w-=7&w,n.mode=16206;break}for(;w<3;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}switch(n.last=1&u,w-=1,3&(u>>>=1)){case 0:n.mode=16193;break;case 1:if(F(n),n.mode=16199,t===p){u>>>=2,w-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=16209}u>>>=2,w-=2;break;case 16193:for(u>>>=7&w,w-=7&w;w<32;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=16209;break}if(n.length=65535&u,u=0,w=0,n.mode=16194,t===p)break e;case 16194:n.mode=16195;case 16195:if(I=n.length){if(I>h&&(I=h),I>c&&(I=c),0===I)break e;o.set(a.subarray(s,s+I),d),h-=I,s+=I,c-=I,d+=I,n.length-=I;break}n.mode=16191;break;case 16196:for(;w<14;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}if(n.nlen=257+(31&u),u>>>=5,w-=5,n.ndist=1+(31&u),u>>>=5,w-=5,n.ncode=4+(15&u),u>>>=4,w-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=16209;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;w<3;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}n.lens[G[n.have++]]=7&u,u>>>=3,w-=3}for(;n.have<19;)n.lens[G[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,i={bits:n.lenbits},j=g(0,n.lens,0,19,n.lencode,0,n.work,i),n.lenbits=i.bits,j){e.msg="invalid code lengths set",n.mode=16209;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;N=(K=n.lencode[u&(1<<n.lenbits)-1])>>>24,C=K>>>16&255,M=65535&K,!(N<=w);){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}if(M<16)u>>>=N,w-=N,n.lens[n.have++]=M;else{if(16===M){for(r=N+2;w<r;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}if(u>>>=N,w-=N,0===n.have){e.msg="invalid bit length repeat",n.mode=16209;break}H=n.lens[n.have-1],I=3+(3&u),u>>>=2,w-=2}else if(17===M){for(r=N+3;w<r;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}u>>>=N,w-=N,H=0,I=3+(7&u),u>>>=3,w-=3}else{for(r=N+7;w<r;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}u>>>=N,w-=N,H=0,I=11+(127&u),u>>>=7,w-=7}if(n.have+I>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=16209;break}for(;I--;)n.lens[n.have++]=H}}if(16209===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=16209;break}if(n.lenbits=9,i={bits:n.lenbits},j=g(1,n.lens,0,n.nlen,n.lencode,0,n.work,i),n.lenbits=i.bits,j){e.msg="invalid literal/lengths set",n.mode=16209;break}if(n.distbits=6,n.distcode=n.distdyn,i={bits:n.distbits},j=g(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,i),n.distbits=i.bits,j){e.msg="invalid distances set",n.mode=16209;break}if(n.mode=16199,t===p)break e;case 16199:n.mode=16200;case 16200:if(h>=6&&c>=258){e.next_out=d,e.avail_out=c,e.next_in=s,e.avail_in=h,n.hold=u,n.bits=w,m(e,Z),d=e.next_out,o=e.output,c=e.avail_out,s=e.next_in,a=e.input,h=e.avail_in,u=n.hold,w=n.bits,16191===n.mode&&(n.back=-1);break}for(n.back=0;N=(K=n.lencode[u&(1<<n.lenbits)-1])>>>24,C=K>>>16&255,M=65535&K,!(N<=w);){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}if(C&&0==(240&C)){for(L=N,z=C,V=M;N=(K=n.lencode[V+((u&(1<<L+z)-1)>>L)])>>>24,C=K>>>16&255,M=65535&K,!(L+N<=w);){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}u>>>=L,w-=L,n.back+=L}if(u>>>=N,w-=N,n.back+=N,n.length=M,0===C){n.mode=16205;break}if(32&C){n.back=-1,n.mode=16191;break}if(64&C){e.msg="invalid literal/length code",n.mode=16209;break}n.extra=15&C,n.mode=16201;case 16201:if(n.extra){for(r=n.extra;w<r;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,w-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;N=(K=n.distcode[u&(1<<n.distbits)-1])>>>24,C=K>>>16&255,M=65535&K,!(N<=w);){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}if(0==(240&C)){for(L=N,z=C,V=M;N=(K=n.distcode[V+((u&(1<<L+z)-1)>>L)])>>>24,C=K>>>16&255,M=65535&K,!(L+N<=w);){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}u>>>=L,w-=L,n.back+=L}if(u>>>=N,w-=N,n.back+=N,64&C){e.msg="invalid distance code",n.mode=16209;break}n.offset=M,n.extra=15&C,n.mode=16203;case 16203:if(n.extra){for(r=n.extra;w<r;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,w-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=16209;break}n.mode=16204;case 16204:if(0===c)break e;if(I=Z-c,n.offset>I){if((I=n.offset-I)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=16209;break}I>n.wnext?(I-=n.wnext,O=n.wsize-I):O=n.wnext-I,I>n.length&&(I=n.length),B=n.window}else B=o,O=d-n.offset,I=n.length;I>c&&(I=c),c-=I,n.length-=I;do o[d++]=B[O++];while(--I);0===n.length&&(n.mode=16200);break;case 16205:if(0===c)break e;o[d++]=n.length,c--,n.mode=16200;break;case 16206:if(n.wrap){for(;w<32;){if(0===h)break e;h--,u|=a[s++]<<w,w+=8}if(Z-=c,e.total_out+=Z,n.total+=Z,4&n.wrap&&Z&&(e.adler=n.check=n.flags?f(n.check,o,Z,d-Z):l(n.check,o,Z,d-Z)),Z=c,4&n.wrap&&(n.flags?u:S(u))!==n.check){e.msg="incorrect data check",n.mode=16209;break}u=0,w=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;w<32;){if(0===h)break e;h--,u+=a[s++]<<w,w+=8}if(4&n.wrap&&u!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=16209;break}u=0,w=0}n.mode=16208;case 16208:j=v;break e;case 16209:j=R;break e;case 16210:return A;default:return x}return e.next_out=d,e.avail_out=c,e.next_in=s,e.avail_in=h,n.hold=u,n.bits=w,(n.wsize||Z!==e.avail_out&&n.mode<16209&&(n.mode<16206||t!==k))&&P(e,e.output,e.next_out,Z-e.avail_out),b-=e.avail_in,Z-=e.avail_out,e.total_in+=b,e.total_out+=Z,n.total+=Z,4&n.wrap&&Z&&(e.adler=n.check=n.flags?f(n.check,o,Z,e.next_out-Z):l(n.check,o,Z,e.next_out-Z)),e.data_type=n.bits+(n.last?64:0)+(16191===n.mode?128:0)+(16199===n.mode||16194===n.mode?256:0),(0===b&&0===Z||t===k)&&j===y&&(j=T),j},s.inflateEnd=e=>{if(D(e))return x;let t=e.state;return t.window&&(t.window=null),e.state=null,y},s.inflateGetHeader=(e,t)=>{if(D(e))return x;let i=e.state;return 0==(2&i.wrap)?x:(i.head=t,t.done=!1,y)},s.inflateSetDictionary=(e,t)=>{let i;let r=t.length;return D(e)?x:0!==(i=e.state).wrap&&16190!==i.mode?x:16190===i.mode&&l(1,t,r,0)!==i.check?R:P(e,t,r,r)?(i.mode=16210,A):(i.havedict=1,y)},s.inflateInfo="pako inflate (from Nodeca project)";var z={};let V=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);z.assign=function(e){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let i=t.shift();if(i){if("object"!=typeof i)throw TypeError(i+"must be non-object");for(let t in i)V(i,t)&&(e[t]=i[t])}}return e},z.flattenChunks=e=>{let t=0;for(let i=0,r=e.length;i<r;i++)t+=e[i].length;let i=new Uint8Array(t);for(let t=0,r=0,n=e.length;t<n;t++){let n=e[t];i.set(n,r),r+=n.length}return i};var H={};let j=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){j=!1}let K=new Uint8Array(256);for(let e=0;e<256;e++)K[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;K[254]=K[254]=1,H.string2buf=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,i,r,n,a,o=e.length,s=0;for(n=0;n<o;n++)55296==(64512&(i=e.charCodeAt(n)))&&n+1<o&&56320==(64512&(r=e.charCodeAt(n+1)))&&(i=65536+(i-55296<<10)+(r-56320),n++),s+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(s),a=0,n=0;a<s;n++)55296==(64512&(i=e.charCodeAt(n)))&&n+1<o&&56320==(64512&(r=e.charCodeAt(n+1)))&&(i=65536+(i-55296<<10)+(r-56320),n++),i<128?t[a++]=i:i<2048?(t[a++]=192|i>>>6,t[a++]=128|63&i):i<65536?(t[a++]=224|i>>>12,t[a++]=128|i>>>6&63,t[a++]=128|63&i):(t[a++]=240|i>>>18,t[a++]=128|i>>>12&63,t[a++]=128|i>>>6&63,t[a++]=128|63&i);return t},H.buf2string=(e,t)=>{let i,r;let n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let a=Array(2*n);for(r=0,i=0;i<n;){let t=e[i++];if(t<128){a[r++]=t;continue}let o=K[t];if(o>4)a[r++]=65533,i+=o-1;else{for(t&=2===o?31:3===o?15:7;o>1&&i<n;)t=t<<6|63&e[i++],o--;o>1?a[r++]=65533:t<65536?a[r++]=t:(t-=65536,a[r++]=55296|t>>10&1023,a[r++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&j)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let i="";for(let r=0;r<t;r++)i+=String.fromCharCode(e[r]);return i})(a,r)},H.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let i=t-1;for(;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+K[e[i]]>t?i:t};let Y={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},G=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},Q=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},W=Object.prototype.toString,{Z_NO_FLUSH:X,Z_FINISH:q,Z_OK:J,Z_STREAM_END:$,Z_NEED_DICT:ee,Z_STREAM_ERROR:et,Z_DATA_ERROR:ei,Z_MEM_ERROR:er}=b;function en(e){this.options=z.assign({chunkSize:65536,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new G,this.strm.avail_out=0;let i=s.inflateInit2(this.strm,t.windowBits);if(i!==J||(this.header=new Q,s.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=H.string2buf(t.dictionary):"[object ArrayBuffer]"===W.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=s.inflateSetDictionary(this.strm,t.dictionary))!==J)))throw Error(Y[i])}function ea(e,t){let i=new en(t);if(i.push(e),i.err)throw i.msg||Y[i.err];return i.result}en.prototype.push=function(e,t){let i,r,n;let a=this.strm,o=this.options.chunkSize,l=this.options.dictionary;if(this.ended)return!1;for(r=t===~~t?t:!0===t?q:X,"[object ArrayBuffer]"===W.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(o),a.next_out=0,a.avail_out=o),(i=s.inflate(a,r))===ee&&l&&((i=s.inflateSetDictionary(a,l))===J?i=s.inflate(a,r):i===ei&&(i=ee));a.avail_in>0&&i===$&&a.state.wrap>0&&0!==e[a.next_in];)s.inflateReset(a),i=s.inflate(a,r);switch(i){case et:case ei:case ee:case er:return this.onEnd(i),this.ended=!0,!1}if(n=a.avail_out,a.next_out&&(0===a.avail_out||i===$)){if("string"===this.options.to){let e=H.utf8border(a.output,a.next_out),t=a.next_out-e,i=H.buf2string(a.output,e);a.next_out=t,a.avail_out=o-t,t&&a.output.set(a.output.subarray(e,e+t),0),this.onData(i)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out))}if(i!==J||0!==n){if(i===$)return i=s.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},en.prototype.onData=function(e){this.chunks.push(e)},en.prototype.onEnd=function(e){e===J&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=z.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},o.Inflate=en,o.inflate=ea,o.inflateRaw=function(e,t){return(t=t||{}).raw=!0,ea(e,t)},o.ungzip=ea,o.constants=b;let eo=Uint16Array.BYTES_PER_ELEMENT,es=Int32Array.BYTES_PER_ELEMENT,el=Uint32Array.BYTES_PER_ELEMENT,ed={METADATA:0,TERRAIN:1,DBROOT:2};return ed.fromString=function(e){return"Metadata"===e?ed.METADATA:"Terrain"===e?ed.TERRAIN:"DbRoot"===e?ed.DBROOT:void 0},i(function(t,i){let n=ed.fromString(t.type),s=t.buffer;r(t.key,s);let l=function(t){let i=new DataView(t),r=0,n=i.getUint32(r,!0);if(r+=el,1953029805!==n&&2917034100!==n)throw new e.RuntimeError("Invalid magic");let a=i.getUint32(r,1953029805===n);r+=el;let s=new Uint8Array(t,r),l=o.inflate(s);if(l.length!==a)throw new e.RuntimeError("Size of packet doesn't match header");return l}(s);s=l.buffer;let d=l.length;switch(n){case ed.METADATA:return function(t,i,r){let n=new DataView(t),o=0,s=n.getUint32(o,!0);if(o+=el,32301!==s)throw new e.RuntimeError("Invalid magic");let l=n.getUint32(o,!0);if(o+=el,1!==l)throw new e.RuntimeError("Invalid data type. Must be 1 for QuadTreePacket");let d=n.getUint32(o,!0);if(o+=el,2!==d)throw new e.RuntimeError("Invalid QuadTreePacket version. Only version 2 is supported.");let f=n.getInt32(o,!0);o+=es;let h=n.getInt32(o,!0);if(o+=es,32!==h)throw new e.RuntimeError("Invalid instance size.");let c=n.getInt32(o,!0);o+=es;let u=n.getInt32(o,!0);o+=es;let w=n.getInt32(o,!0);if(c!==f*h+(o+=es))throw new e.RuntimeError("Invalid dataBufferOffset");if(c+u+w!==i)throw new e.RuntimeError("Invalid packet offsets");let b=[];for(let e=0;e<f;++e){let e=n.getUint8(o);++o,++o;let t=n.getUint16(o,!0);o+=eo;let i=n.getUint16(o,!0);o+=eo;let r=n.getUint16(o,!0);o+=eo+eo+eo+es+es+8;let s=n.getUint8(o++),l=n.getUint8(o++);o+=eo,b.push(new a(e,t,i,r,s,l))}let m=[],g=0,k=0,_=b[g++];return""===r?++k:m[r]=_,function e(t,i,r){let n=!1;if(4===r){if(i.hasSubtree())return;n=!0}for(let a=0;a<4;++a){let o=t+a.toString();if(n)m[o]=null;else if(r<4){if(i.hasChild(a)){if(g===f)return void console.log("Incorrect number of instances");let t=b[g++];m[o]=t,e(o,t,r+1)}else m[o]=null}}}(r,_,k),m}(s,d,t.quadKey);case ed.TERRAIN:return function(t,i,r){let n=new DataView(t),a=0,o=[];for(;o.length<5;){let s=a;a=function(t){for(let r=0;r<4;++r){let r=n.getUint32(t,!0);if((t+=el+r)>i)throw new e.RuntimeError("Malformed terrain packet found.")}return t}(a);let l=t.slice(s,a);r.push(l),o.push(l)}return o}(s,d,i);case ed.DBROOT:return i.push(s),{buffer:s}}})});