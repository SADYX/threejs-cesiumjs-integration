define(["exports","./AxisAlignedBoundingBox-39ab50d0","./Matrix2-413c4048","./Matrix3-81054f0f","./defaultValue-f6d5e6da","./IntersectionTests-357c3d7f","./Plane-6add0ae1","./Transforms-fce95115"],function(t,e,n,i,r,o,a,s){"use strict";let l=new n.Cartesian4;function d(t,e){t=(e=r.defaultValue(e,i.Ellipsoid.WGS84)).scaleToGeodeticSurface(t);let o=s.Transforms.eastNorthUpToFixedFrame(t,e);this._ellipsoid=e,this._origin=t,this._xAxis=i.Cartesian3.fromCartesian4(n.Matrix4.getColumn(o,0,l)),this._yAxis=i.Cartesian3.fromCartesian4(n.Matrix4.getColumn(o,1,l));let d=i.Cartesian3.fromCartesian4(n.Matrix4.getColumn(o,2,l));this._plane=a.Plane.fromPointNormal(t,d)}Object.defineProperties(d.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});let c=new e.AxisAlignedBoundingBox;d.fromPoints=function(t,n){return new d(e.AxisAlignedBoundingBox.fromPoints(t,c).center,n)};let f=new o.Ray,p=new i.Cartesian3;d.prototype.projectPointOntoPlane=function(t,e){let a=f;a.origin=t,i.Cartesian3.normalize(t,a.direction);let s=o.IntersectionTests.rayPlane(a,this._plane,p);if(r.defined(s)||(i.Cartesian3.negate(a.direction,a.direction),s=o.IntersectionTests.rayPlane(a,this._plane,p)),r.defined(s)){let t=i.Cartesian3.subtract(s,this._origin,s),o=i.Cartesian3.dot(this._xAxis,t),a=i.Cartesian3.dot(this._yAxis,t);return r.defined(e)?(e.x=o,e.y=a,e):new n.Cartesian2(o,a)}},d.prototype.projectPointsOntoPlane=function(t,e){r.defined(e)||(e=[]);let n=0,i=t.length;for(let o=0;o<i;o++){let i=this.projectPointOntoPlane(t[o],e[n]);r.defined(i)&&(e[n]=i,n++)}return e.length=n,e},d.prototype.projectPointToNearestOnPlane=function(t,e){r.defined(e)||(e=new n.Cartesian2);let a=f;a.origin=t,i.Cartesian3.clone(this._plane.normal,a.direction);let s=o.IntersectionTests.rayPlane(a,this._plane,p);r.defined(s)||(i.Cartesian3.negate(a.direction,a.direction),s=o.IntersectionTests.rayPlane(a,this._plane,p));let l=i.Cartesian3.subtract(s,this._origin,s),d=i.Cartesian3.dot(this._xAxis,l),c=i.Cartesian3.dot(this._yAxis,l);return e.x=d,e.y=c,e},d.prototype.projectPointsToNearestOnPlane=function(t,e){r.defined(e)||(e=[]);let n=t.length;e.length=n;for(let i=0;i<n;i++)e[i]=this.projectPointToNearestOnPlane(t[i],e[i]);return e};let u=new i.Cartesian3;d.prototype.projectPointOntoEllipsoid=function(t,e){r.defined(e)||(e=new i.Cartesian3);let n=this._ellipsoid,o=this._origin,a=this._xAxis,s=this._yAxis;return i.Cartesian3.multiplyByScalar(a,t.x,u),e=i.Cartesian3.add(o,u,e),i.Cartesian3.multiplyByScalar(s,t.y,u),i.Cartesian3.add(e,u,e),n.scaleToGeocentricSurface(e,e),e},d.prototype.projectPointsOntoEllipsoid=function(t,e){let n=t.length;r.defined(e)?e.length=n:e=Array(n);for(let i=0;i<n;++i)e[i]=this.projectPointOntoEllipsoid(t[i],e[i]);return e},t.EllipsoidTangentPlane=d});