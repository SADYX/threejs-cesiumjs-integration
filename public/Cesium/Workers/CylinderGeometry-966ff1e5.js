define(["exports","./Transforms-fce95115","./Matrix2-413c4048","./Matrix3-81054f0f","./ComponentDatatype-ab629b88","./CylinderGeometryLibrary-f49f33a8","./defaultValue-f6d5e6da","./GeometryAttribute-81ff775c","./GeometryAttributes-1e4ddcd2","./GeometryOffsetAttribute-2579b8d2","./IndexDatatype-d3db4e7d","./Math-2ce22ee9","./VertexFormat-fbdec922"],function(t,e,a,n,r,o,i,s,u,m,l,d,f){"use strict";let p;let y=new a.Cartesian2,b=new n.Cartesian3,c=new n.Cartesian3,A=new n.Cartesian3,x=new n.Cartesian3;function g(t){let e=(t=i.defaultValue(t,i.defaultValue.EMPTY_OBJECT)).length,a=t.topRadius,n=t.bottomRadius,r=i.defaultValue(t.vertexFormat,f.VertexFormat.DEFAULT),o=i.defaultValue(t.slices,128);this._length=e,this._topRadius=a,this._bottomRadius=n,this._vertexFormat=f.VertexFormat.clone(r),this._slices=o,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}g.packedLength=f.VertexFormat.packedLength+5,g.pack=function(t,e,a){return a=i.defaultValue(a,0),f.VertexFormat.pack(t._vertexFormat,e,a),a+=f.VertexFormat.packedLength,e[a++]=t._length,e[a++]=t._topRadius,e[a++]=t._bottomRadius,e[a++]=t._slices,e[a]=i.defaultValue(t._offsetAttribute,-1),e};let _=new f.VertexFormat,h={vertexFormat:_,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};g.unpack=function(t,e,a){e=i.defaultValue(e,0);let n=f.VertexFormat.unpack(t,e,_);e+=f.VertexFormat.packedLength;let r=t[e++],o=t[e++],s=t[e++],u=t[e++],m=t[e];return i.defined(a)?(a._vertexFormat=f.VertexFormat.clone(n,a._vertexFormat),a._length=r,a._topRadius=o,a._bottomRadius=s,a._slices=u,a._offsetAttribute=-1===m?void 0:m,a):(h.length=r,h.topRadius=o,h.bottomRadius=s,h.slices=u,h.offsetAttribute=-1===m?void 0:m,new g(h))},g.createGeometry=function(t){let f,p=t._length,g=t._topRadius,_=t._bottomRadius,h=t._vertexFormat,F=t._slices;if(p<=0||g<0||_<0||0===g&&0===_)return;let v=F+F,C=F+v,w=v+v,G=o.CylinderGeometryLibrary.computePositions(p,g,_,F,!0),V=h.st?new Float32Array(2*w):void 0,D=h.normal?new Float32Array(3*w):void 0,R=h.tangent?new Float32Array(3*w):void 0,T=h.bitangent?new Float32Array(3*w):void 0,O=h.normal||h.tangent||h.bitangent;if(O){let t=h.tangent||h.bitangent,e=0,a=0,r=0,o=Math.atan2(_-g,p),i=b;i.z=Math.sin(o);let s=Math.cos(o),u=A,m=c;for(f=0;f<F;f++){let o=f/F*d.CesiumMath.TWO_PI,l=s*Math.cos(o),p=s*Math.sin(o);O&&(i.x=l,i.y=p,t&&(u=n.Cartesian3.normalize(n.Cartesian3.cross(n.Cartesian3.UNIT_Z,i,u),u)),h.normal&&(D[e++]=i.x,D[e++]=i.y,D[e++]=i.z,D[e++]=i.x,D[e++]=i.y,D[e++]=i.z),h.tangent&&(R[a++]=u.x,R[a++]=u.y,R[a++]=u.z,R[a++]=u.x,R[a++]=u.y,R[a++]=u.z),h.bitangent&&(m=n.Cartesian3.normalize(n.Cartesian3.cross(i,u,m),m),T[r++]=m.x,T[r++]=m.y,T[r++]=m.z,T[r++]=m.x,T[r++]=m.y,T[r++]=m.z))}for(f=0;f<F;f++)h.normal&&(D[e++]=0,D[e++]=0,D[e++]=-1),h.tangent&&(R[a++]=1,R[a++]=0,R[a++]=0),h.bitangent&&(T[r++]=0,T[r++]=-1,T[r++]=0);for(f=0;f<F;f++)h.normal&&(D[e++]=0,D[e++]=0,D[e++]=1),h.tangent&&(R[a++]=1,R[a++]=0,R[a++]=0),h.bitangent&&(T[r++]=0,T[r++]=1,T[r++]=0)}let L=l.IndexDatatype.createTypedArray(w,12*F-12),M=0,P=0;for(f=0;f<F-1;f++)L[M++]=P,L[M++]=P+2,L[M++]=P+3,L[M++]=P,L[M++]=P+3,L[M++]=P+1,P+=2;for(L[M++]=v-2,L[M++]=0,L[M++]=1,L[M++]=v-2,L[M++]=1,L[M++]=v-1,f=1;f<F-1;f++)L[M++]=v+f+1,L[M++]=v+f,L[M++]=v;for(f=1;f<F-1;f++)L[M++]=C,L[M++]=C+f,L[M++]=C+f+1;let k=0;if(h.st){let t=Math.max(g,_);for(f=0;f<w;f++){let e=n.Cartesian3.fromArray(G,3*f,x);V[k++]=(e.x+t)/(2*t),V[k++]=(e.y+t)/(2*t)}}let z=new u.GeometryAttributes;h.position&&(z.position=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:G})),h.normal&&(z.normal=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:D})),h.tangent&&(z.tangent=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R})),h.bitangent&&(z.bitangent=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:T})),h.st&&(z.st=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:V})),y.x=.5*p,y.y=Math.max(_,g);let E=new e.BoundingSphere(n.Cartesian3.ZERO,a.Cartesian2.magnitude(y));if(i.defined(t._offsetAttribute)){p=G.length;let e=t._offsetAttribute===m.GeometryOffsetAttribute.NONE?0:1,a=new Uint8Array(p/3).fill(e);z.applyOffset=new s.GeometryAttribute({componentDatatype:r.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:a})}return new s.Geometry({attributes:z,indices:L,primitiveType:s.PrimitiveType.TRIANGLES,boundingSphere:E,offsetAttribute:t._offsetAttribute})},g.getUnitCylinder=function(){return i.defined(p)||(p=g.createGeometry(new g({topRadius:1,bottomRadius:1,length:1,vertexFormat:f.VertexFormat.POSITION_ONLY}))),p},t.CylinderGeometry=g});